/* Updated print.css */
body, html {
    width: 100%;
    height: 100%;
    margin: 0;
    padding: 0;
    -webkit-print-color-adjust: exact;
    print-color-adjust: exact;
}

* {
    box-sizing: border-box;
}

.page {
    position: relative;
    display: flex;
    flex-direction: column;
    width: 210mm;
    min-height: 297mm; /* Changed from fixed height to min-height */
    height: 297mm; /* Set exact height for A4 */
    padding: 13mm;
    margin: 0 auto; /* Center the page */
    background: #fff;
    box-shadow: 0 0 5px rgba(0, 0, 0, 0.1);
    border: 1px solid #D3D3D3;
    page-break-after: avoid; /* Prevent page break after */
    page-break-before: avoid; /* Prevent page break before */
}

.subpage-w {
    flex: 1;
    display: flex;
    flex-direction: column;
    overflow: hidden; /* Prevents content overflow */
}

.footer {
    position: absolute;
    bottom: 13mm; /* Match the page padding */
    left: 13mm;
    right: 13mm;
    width: calc(100% - 26mm); /* Account for left and right padding */
    page-break-before: avoid; /* Prevent page break before footer */
}

.number-page {
    position: absolute;
    bottom: 40px;
    right: 50px;
}

@page {
    size: A4;
    margin: 0;
}

@media print {
    html, body {
        width: 100%;
        height: 100%;
        margin: 0;
        padding: 0;
    }

    .page {
        margin: 0;
        border: initial;
        border-radius: initial;
        width: 210mm;
        height: 297mm;
        min-height: 297mm;
        box-shadow: initial;
        background: #fff !important;
        page-break-after: always !important;
        page-break-inside: avoid !important;
        position: relative;
    }

    .footer {
        position: absolute;
        bottom: 13mm;
        left: 13mm;
        right: 13mm;
        width: calc(100% - 26mm);
    }

    /* Prevent page breaks inside critical elements */
    table, tr, td, th {
        page-break-inside: avoid !important;
    }

    /* Avoid orphaned headers */
    h1, h2, h3, h4, h5, h6 {
        page-break-after: avoid !important;
    }

    /* Clear floats to prevent layout issues */
    .row::after {
        content: "";
        display: table;
        clear: both;
    }
}
